<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
     <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/rellax/1.12.1/rellax.min.js"></script>
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
     <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>    
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <!-- jQuery -->
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

   <!-- DataTables CSS & JS -->
   <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" />
   <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>


   <!-- Toastify JS -->
   <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

    {{ template "sidebar" }}
    {{ template "Edit_barang"}}
    {{ template "Hapus_Barang_Entry_Total"}}
   <div id="admin_kontrol" class="p-4 sm:ml-64 space-y-6 bg-gray-50 min-h-screen">

   <div style="display: grid; grid-template-columns: auto 1fr; align-items: center; gap: 12px;">
   <div style="font-size: 1.5rem; font-weight: 500; font-family: 'Sauce', sans-serif;">
      Kontrol Barang
   </div>
   <hr style="border: none; border-top: 2px solid #94a3b8; margin: 0;">
   </div>


      <div style="flex: 12; background: white;  border-radius: 10px; overflow-x: auto; white-space: nowrap;">
  <div class="swiper-container mySwiper" style="width: 100%; overflow: hidden; padding: 5px;">
    <div class="swiper-wrapper" style="display: flex; gap: 15px;">

      <!-- Semua -->
      <div id="Semua" class="short_cut swiper-slide" style=" background: linear-gradient(to right, #6366f1, #3b82f6); border-radius: 15px; padding: 12px; text-align: center; cursor: pointer;">
        <i class="fas fa-tshirt" style="font-size: 1.8rem; color: white;"></i>
        <div style="color: white; font-weight: bold; margin-top: 6px;">Semua</div>
        <small style="color: white; opacity: 0.9;">Lihat semua kategori</small>
      </div>

      <!-- Baju -->
      <div id="Baju" class="short_cut swiper-slide" style="
      background: linear-gradient(to right, #34d399, #10b981); 
      border-radius: 15px; 
      padding: 14px; 
      cursor: pointer; 
      color: white; 
      font-size: 0.75rem; 
      height: 100px;

      display: grid; 
      grid-template-columns: 1fr auto; 
      grid-template-rows: auto auto; 
      gap: 6px 12px;
      align-items: center;
      text-align: left;
      ">

      <!-- Ikon + Nama (grid area: row 1 / col 1) -->
      <div style="display: flex; align-items: center; gap: 8px; grid-column: 1 / 2; grid-row: 1 / 2;">
         <i class="ri-shirt-fill" style="font-size: 1.6rem; color: white;"></i>
         <div style="font-weight: bold; font-size: 0.9rem;">Baju</div>
      </div>

      <!-- Jumlah total (grid area: row 1 / col 2) -->
      <div style="grid-column: 2 / 3; grid-row: 1 / 2; font-weight: bold; font-size: 0.85rem;">
         Jumlah varian: <span id="Jumlah_baju">38</span>
      </div>

      <!-- CTA Admin (grid area: row 2 / col 1) -->
      <div style="font-size: 0.7rem; opacity: 0.9; grid-column: 1 / 2; grid-row: 2 / 3;">
         Ketuk untuk mengontrol baju
      </div>

      <!-- Sudah terjual (grid area: row 2 / col 2) -->
      <div style="grid-column: 2 / 3; grid-row: 2 / 3; font-weight: bold; font-size: 0.85rem;">
         Sudah terjual: <span id="Jumlah_baju_terjual">38</span>
      </div>

      </div>



      <!-- Celana -->
      <div id="Celana" class="short_cut swiper-slide" style="
      width: 160px; 
      background: linear-gradient(to right, #f59e0b, #fbbf24); 
      border-radius: 15px; 
      padding: 14px; 
      cursor: pointer; 
      color: white; 
      font-size: 0.75rem; 
      height: 100px;

      display: grid; 
      grid-template-columns: 1fr auto; 
      grid-template-rows: auto auto; 
      gap: 6px 12px;
      align-items: center;
      text-align: left;
      ">

      <!-- Ikon + Nama -->
      <div style="display: flex; align-items: center; gap: 8px; grid-column: 1 / 2; grid-row: 1 / 2;">
         <i class="fas fa-user-tie" style="font-size: 1.6rem; color: white;"></i>
         <div style="font-weight: bold; font-size: 0.9rem;">Celana</div>
      </div>

      <!-- Jumlah total -->
      <div style="grid-column: 2 / 3; grid-row: 1 / 2; font-weight: bold; font-size: 0.85rem;">
         Jumlah varian: <span id="Jumlah_celana">38</span>
      </div>

      <!-- CTA Admin -->
      <div style="font-size: 0.7rem; opacity: 0.9; grid-column: 1 / 2; grid-row: 2 / 3;">
         Kelola stok celana
      </div>

      <!-- Sudah terjual -->
      <div style="grid-column: 2 / 3; grid-row: 2 / 3; font-weight: bold; font-size: 0.85rem;">
         Sudah terjual: <span id="Jumlah_celana_terjual">38</span>
      </div>

      </div>


      <!-- Kacamata -->
      <div id="Kacamata" class="short_cut swiper-slide" style="
      width: 160px; 
      background: linear-gradient(to right, #06b6d4, #3b82f6); 
      border-radius: 15px; 
      padding: 14px; 
      cursor: pointer; 
      color: white; 
      font-size: 0.75rem; 
      height: 100px;


      display: grid; 
      grid-template-columns: 1fr auto; 
      grid-template-rows: auto auto; 
      gap: 6px 12px;
      align-items: center;
      text-align: left;
      ">

      <!-- Ikon + Nama -->
      <div style="display: flex; align-items: center; gap: 8px; grid-column: 1 / 2; grid-row: 1 / 2;">
         <i class="fas fa-glasses" style="font-size: 1.6rem; color: white;"></i>
         <div style="font-weight: bold; font-size: 0.9rem;">Kacamata</div>
      </div>

      <!-- Jumlah total -->
      <div style="grid-column: 2 / 3; grid-row: 1 / 2; font-weight: bold; font-size: 0.85rem;">
         Jumlah varian: <span id="Jumlah_kacamata">38</span>
      </div>

      <!-- CTA Admin -->
      <div style="font-size: 0.7rem; opacity: 0.9; grid-column: 1 / 2; grid-row: 2 / 3;">
         Pantau koleksi
      </div>

      <!-- Sudah terjual -->
      <div style="grid-column: 2 / 3; grid-row: 2 / 3; font-weight: bold; font-size: 0.85rem;">
         Sudah terjual: <span id="Jumlah_kacamata_terjual">38</span>
      </div>

      </div>


            <!-- Tas -->

      <div id="Tas" class="short_cut swiper-slide" style="
      width: 160px; 
      background: linear-gradient(to right, #ec4899, #ef4444); 
      border-radius: 15px; 
      padding: 14px; 
      cursor: pointer; 
      color: white; 
      font-size: 0.75rem; 
      height: 100px;

      display: grid; 
      grid-template-columns: 1fr auto; 
      grid-template-rows: auto auto; 
      gap: 6px 12px;
      align-items: center;
      text-align: left;
      ">

      <!-- Ikon + Nama -->
      <div style="display: flex; align-items: center; gap: 8px; grid-column: 1 / 2; grid-row: 1 / 2;">
         <i class="fas fa-shopping-bag" style="font-size: 1.6rem; color: white;"></i>
         <div style="font-weight: bold; font-size: 0.9rem;">Tas</div>
      </div>

      <!-- Jumlah total -->
      <div style="grid-column: 2 / 3; grid-row: 1 / 2; font-weight: bold; font-size: 0.85rem;">
         Jumlah varian: <span id="Jumlah_tas">38</span>
      </div>

      <!-- CTA Admin -->
      <div style="font-size: 0.7rem; opacity: 0.9; grid-column: 1 / 2; grid-row: 2 / 3;">
         Manajemen item
      </div>

      <!-- Sudah terjual -->
      <div style="grid-column: 2 / 3; grid-row: 2 / 3; font-weight: bold; font-size: 0.85rem;">
         Sudah terjual: <span id="Jumlah_tas_terjual">38</span>
      </div>

      </div>

            

            <!-- Sepatu -->
      <div id="Sepatu" class="short_cut swiper-slide" style="
      width: 160px; 
      background: linear-gradient(to right, #8b5cf6, #6366f1); 
      border-radius: 15px; 
      padding: 14px; 
      cursor: pointer; 
      color: white; 
      font-size: 0.75rem; 
      height: 100px;

      display: grid; 
      grid-template-columns: 1fr auto; 
      grid-template-rows: auto auto; 
      gap: 6px 12px;
      align-items: center;
      text-align: left;
      ">

      <!-- Ikon + Nama -->
      <div style="display: flex; align-items: center; gap: 8px; grid-column: 1 / 2; grid-row: 1 / 2;">
         <span style="font-size: 1.6rem;">üëü</span>
         <div style="font-weight: bold; font-size: 0.9rem;">Sepatu</div>
      </div>

      <!-- Jumlah total -->
      <div style="grid-column: 2 / 3; grid-row: 1 / 2; font-weight: bold; font-size: 0.85rem;">
         Jumlah varian: <span id="Jumlah_sepatu">38</span>
      </div>

      <!-- CTA Admin -->
      <div style="font-size: 0.7rem; opacity: 0.9; grid-column: 1 / 2; grid-row: 2 / 3;">
         Kontrol sepatu
      </div>

      <!-- Sudah terjual -->
      <div style="grid-column: 2 / 3; grid-row: 2 / 3; font-weight: bold; font-size: 0.85rem;">
         Sudah terjual: <span id="Jumlah_sepatu_terjual">38</span>
      </div>

      </div>


      <!-- Dll -->
      <div id="dll" class="short_cut swiper-slide" style="width: 120px; background: linear-gradient(to right, #9ca3af, #6b7280); border-radius: 15px; padding: 12px; text-align: center; cursor: pointer;">
        <i class="fas fa-ellipsis-h" style="font-size: 1.8rem; color: white;"></i>
        <div style="color: white; font-weight: bold; margin-top: 6px;">Lainnya</div>
        <small style="color: white; opacity: 0.9;">Kategori lain</small>
      </div>

    </div>
  </div>
</div>


  <!-- Filter dan Search -->
   <div class="flex flex-col space-y-3">
  <div class="flex items-center justify-between">
    <button class="border rounded-full px-4 py-1 text-sm text-gray-700 shadow-sm hover:bg-gray-100 transition">
      Berdasarkan
    </button>

    <div class="relative w-1/2">
      <input 
        type="text" 
        class="w-full px-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-blue-300" 
        placeholder="Cari barang..."
        aria-label="Search items"
      >
      <svg class="absolute right-4 top-3 w-4 h-4 text-gray-500 pointer-events-none" fill="currentColor" viewBox="0 0 20 20">
        <path d="M12.9 14.32a8 8 0 111.414-1.414l5.387 5.387-1.414 1.414-5.387-5.387zM8 14a6 6 0 100-12 6 6 0 000 12z"/>
      </svg>
      <!-- Loading spinner (hidden by default) -->
      <div class="absolute right-10 top-3 w-4 h-4 border-2 border-blue-400 border-t-transparent rounded-full animate-spin hidden" id="loadingSpinner"></div>
    </div>

    <!-- Dropdown sorting -->
    <select class="border rounded-full px-3 py-1 text-sm text-gray-700 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-300" aria-label="Sort items">
      <option value="relevance">Relevansi</option>
      <option value="newest">Terbaru</option>
      <option value="lowest-price">Harga Terendah</option>
      <option value="highest-price">Harga Tertinggi</option>
    </select>
  </div>

  <!-- Info hasil pencarian -->
  <div class="text-sm text-gray-600">
    <span id="resultCount"> </span> barang ditemukan
  </div>
</div>


   <!-- Daftar Produk -->
   <div id="table_produk" style="max-height: 400px; overflow-y: auto;" class="space-y-4">
  
   <div class="bg-gray-200 rounded-2xl p-4 shadow-inner space-y-2 mx-auto">

   <div class="grid grid-cols-[2.5rem_1fr_12.5rem_9.375rem_7.5rem] gap-4 items-center">
      <!-- Kolom 1: Nomor -->
      <p class="font-semibold text-lg">1.</p>
      
      <!-- Kolom 2: Nama ‚Ä¢ Jenis -->
      <div>
         <p class="font-semibold text-lg">Nama ‚Ä¢ Jenis</p>
         <p class="text-sm text-gray-700">Harga ‚Ä¢ Stok</p>
      </div>
      
      <!-- Kolom 3: Memiliki Diskon dan Berakhir Pada -->
      <div class="text-sm text-gray-600 space-y-1">
         <p>Memiliki diskon: <span class="font-semibold text-red-600">48%</span></p>
         <p>Berakhir pada: <span class="font-semibold">31 Des 2025</span></p>
      </div>

      <!-- Kolom 4: Tersedia dan Terjual -->
      <div class="text-sm text-gray-600 space-y-1">
         <p>Tersedia: <span class="font-semibold">100</span></p>
         <p>Terjual: <span class="font-semibold">50</span></p>
      </div>

      <!-- Kolom 5: Ikon -->
      <div class="flex space-x-3 justify-end">
         <button class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-xl hover:bg-gray-400 cursor-pointer" aria-label="Edit">
         ‚úèÔ∏è
         </button>
         <button class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-xl hover:bg-red-400 cursor-pointer" aria-label="Delete">
         üóëÔ∏è
         </button>
         <button class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-xl hover:bg-gray-400 cursor-pointer" aria-label="View Image">
         üñºÔ∏è
         </button>
      </div>
   </div>

   </div>

  <!-- Item Produk 3 -->
  <div class="bg-gray-200 rounded-2xl p-4 space-y-2 shadow-inner">
    <div class="flex justify-between items-center">
      <div>
        <p class="font-semibold text-lg">3. Nama ‚Ä¢ Jenis</p>
        <p class="text-sm text-gray-700">Harga ‚Ä¢ Stok</p>
      </div>
      <div class="flex space-x-3">
        <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-xl hover:bg-gray-400 cursor-pointer">‚úèÔ∏è</div>
        <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-xl hover:bg-red-400 cursor-pointer">üóëÔ∏è</div>
        <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-xl hover:bg-gray-400 cursor-pointer">üñºÔ∏è</div>
      </div>
    </div>
    <div class="text-sm text-gray-600">
      <p>Memiliki diskon:</p>
      <p>Berakhir Pada:</p>
    </div>
  </div>

  <!-- Item Produk 4 -->
  <div class="bg-gray-200 rounded-2xl p-4 space-y-2 shadow-inner">
    <div class="flex justify-between items-center">
      <div>
        <p class="font-semibold text-lg">4. Nama ‚Ä¢ Jenis</p>
        <p class="text-sm text-gray-700">Harga ‚Ä¢ Stok</p>
      </div>
      <div class="flex space-x-3">
        <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-xl hover:bg-gray-400 cursor-pointer">‚úèÔ∏è</div>
        <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-xl hover:bg-red-400 cursor-pointer">üóëÔ∏è</div>
        <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-xl hover:bg-gray-400 cursor-pointer">üñºÔ∏è</div>
      </div>
    </div>
    <div class="text-sm text-gray-600">
      <p>Memiliki diskon:</p>
      <p>Berakhir Pada:</p>
    </div>
  </div>
</div>


   <!-- Tombol Tambah -->
   <div class="flex justify-center space-x-4 pt-4">
      <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center text-2xl font-bold hover:bg-gray-400 cursor-pointer">+</div>
      <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center text-2xl font-bold hover:bg-gray-400 cursor-pointer">+</div>
      <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center text-2xl font-bold hover:bg-gray-400 cursor-pointer">+</div>
      <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center text-2xl font-bold hover:bg-gray-400 cursor-pointer">+</div>
      <div class="w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center text-2xl font-bold hover:bg-gray-400 cursor-pointer">+</div>
   </div>
   </div>

<script>
   const elemen_short_cut = document.querySelectorAll(".short_cut");
   let pencarian_short_cut = "";

   const jumlah_baju = document.getElementById("Jumlah_baju");
   const jumlah_baju_terjual = document.getElementById("Jumlah_baju_terjual");
   const jumlah_celana = document.getElementById("Jumlah_celana");
   const jumlah_celana_terjual = document.getElementById("Jumlah_celana_terjual");
   const jumlah_kacamata = document.getElementById("Jumlah_kacamata");
   const jumlah_kacamata_terjual = document.getElementById("Jumlah_kacamata_terjual");
   const jumlah_tas = document.getElementById("Jumlah_tas");
   const jumlah_tas_terjual = document.getElementById("Jumlah_tas_terjual");
   const jumlah_sepatu = document.getElementById("Jumlah_sepatu");
   const jumlah_sepatu_terjual = document.getElementById("Jumlah_sepatu_terjual");


   elemen_short_cut.forEach((element) => {
      element.addEventListener("click", (el) => {
         console.log(element.id);
         pencarian_short_cut = element.id;
         // Panggil AmbilData di sini setelah pencarian_short_cut diupdate
         AmbilData(element.id)
      });
   });

   if (jumlah_baju && jumlah_celana && jumlah_kacamata && jumlah_tas && jumlah_sepatu) {
         fetchData().then(data => {
         if (data) {
            console.log("Data yang diproses:", data);
         } else {
            console.log("Pengambilan data gagal.");
         }
      });
   }

   if(pencarian_short_cut == ""){
    AmbilData("Semua");
   }

   async function fetchData() {
         try {
            const response = await fetch("/app/endpoint.go", {
            method: "POST",
            headers: {
               "Content-Type": "application/json",
            },
            body: JSON.stringify({
               tujuan: "Ambil_Data_ui_short"
            }),
            });

            if (!response.ok) {
            console.error("Gagal mengambil data:", response.status, response.statusText, await response.text());
            throw new Error(`Gagal mengambil data: ${response.status} ${response.statusText}`);
            }

            const data = await response.json(); // Parse respons JSON
            console.log("Data berhasil diambil:", data);

            jumlah_baju.innerHTML = data.total_baju;
            jumlah_celana.innerHTML = data.total_celana;
            jumlah_kacamata.innerHTML = data.total_kacamata;
            jumlah_sepatu.innerHTML = data.total_sepatu;
            jumlah_tas.innerHTML = data.total_tas;
            jumlah_barang_custom.innerHTML = data.total_barang_custom;


            // Lakukan sesuatu dengan data di sini, misalnya:
            // updateUI(data);

            return data; // Mengembalikan data agar bisa digunakan di luar fungsi
         } catch (error) {
            console.error("Terjadi kesalahan:", error);
            // Tampilkan pesan kesalahan kepada pengguna atau lakukan penanganan lain
            // Misalnya:
            // displayError("Terjadi kesalahan saat mengambil data.");
            return null; // Mengembalikan null atau nilai default jika terjadi kesalahan
         }
      }
   
   async function AmbilData(Jenis) {
      try {
         const response = await fetch("/app/endpoint.go", {
            method: "POST",
            headers: {
            "Content-Type": "application/json",
            },
            body: JSON.stringify({
            tujuan: "Ambil_Data_Admin_Short",
            jenis: Jenis,
            }),
         });

         if (!response.ok) {
            throw new Error("Gagal mengambil data: " + response.statusText);
         }

         const data = await response.json();
         console.log("Data berhasil diambil:", data);

         const tableProduk = document.getElementById("table_produk");
         tableProduk.innerHTML = ""; // Bersihkan konten sebelumnya

         

         document.getElementById("resultCount").innerHTML = data[data.length - 1].Jumlah_Barang;

         for (const [index, datanya] of data.entries()) {
            try {
               const response = await fetch("/app/endpoint.go", {
                     method: "POST",
                     headers: {
                        "Content-Type": "application/json",
                     },
                     body: JSON.stringify({
                        tujuan: "ambil_foto",
                        data: {
                           nama: datanya.nama,
                           jenis_pakaian: datanya.jenis_pakaian,
                        },
                     }),
               });

               // Ambil blob dari response
               const blob = await response.blob();
               const imgSrc = URL.createObjectURL(blob); // Buat object URL dari blob

               const cardHTML = `
               <div class="relative bg-white rounded-2xl p-5 shadow-md hover:shadow-lg transition-all duration-300 ease-in-out mx-auto">
            
                     <!-- Badge kategori -->
                     <div class=" w-min-xl absolute top-2 left-2 bg-teal-100 text-teal-700 text-xs font-semibold px-2 py-1 rounded">
                        ${datanya.kategori}
                     </div>

                     <div class="grid grid-cols-[2.5rem_1fr_12.5rem_6rem_10rem] gap-4 items-center">

                        <p class="font-semibold text-gray-700 text-lg">${index + 1}.</p>

                        <div>
                              <p class="font-semibold text-gray-800 text-lg">${datanya.nama} ‚Ä¢ ${datanya.jenis_pakaian}</p>
                              <p class="text-sm text-gray-500">${datanya.harga} ‚Ä¢ ${datanya.stok}</p>
                        </div>

                        <div class="text-sm text-gray-600 space-y-1">
                              <p>Kategori: <span class="font-semibold text-gray-800">${datanya.kategori}</span></p>
                              <p>Warna: <span class="font-semibold text-gray-800">${datanya.warna}</span></p>
                        </div>

                        <div class="text-sm text-gray-600 space-y-1">
                              <p>Gender: <span class="font-semibold text-gray-800">${datanya.gender}</span></p>
                              <p>Ukuran: <span class="font-semibold text-gray-800">${datanya.ukuran}</span></p>
                        </div>

                        <div class="flex space-x-2 justify-end gap-2">
                              <button style="margin-top:25px;" onclick="Edit_barang('${imgSrc}', '${datanya.nama}', '${datanya.gender}', '${datanya.deskripsi}', '${datanya.ukuran}')" class="w-9 h-9 bg-blue-100 hover:bg-slate-200 text-slate-600 rounded-full flex items-center justify-center shadow transition" aria-label="Edit">
                                 <i class="fas fa-pen"></i>
                              </button>
                              <button style="margin-top:25px;" onclick="Hapus_Barang_Entry('${datanya.id_barang}', '${datanya.nama}', '${datanya.jenis_pakaian}', '${datanya.gender}', '${datanya.harga}')" class="w-9 h-9 bg-red-100 hover:bg-red-200 text-red-600 rounded-full flex items-center justify-center shadow transition" aria-label="Delete">
                                 <i class="fas fa-trash-alt"></i>
                              </button>
                              <div style="height:100px; width:87px; " class="bg-gray-100 hover:bg-gray-200 rounded-lg overflow-hidden shadow flex items-center justify-center" aria-label="View Image">
                                 <img src="${imgSrc}" alt="Foto Barang" class="object-cover w-full h-full" />
                              </div>
                        </div>

                     </div>
                  </div>

               `;

               tableProduk.innerHTML += cardHTML;
            } catch (err) {
               console.error("Gagal ambil foto (blob) untuk:", datanya.nama, err);
            }
         }


      } catch (error) {
         console.error("Terjadi kesalahan:", error);
         return null;
      }
   }


      var swiper = new Swiper(".mySwiper", {
         slidesPerView: 3,
         spaceBetween: 30,
         freeMode: true,
      });
</script>

<script>
async function HapusChildBarang(kode, nama, jenis, ukuran, id_induk){
const response = await fetch("/app/endpoint.go", {
         method: "POST",
         headers: {
            "Content-Type": "application/json",
         },
         body: JSON.stringify({
            tujuan: "Hapus_Salah_Satu_stok",
            nama: `${nama}`,
            id_barang: `${id_induk}`,
            jenis: `${jenis}`,
            ukuran: `${ukuran}`,
            kode_barang: `${kode}`,

         }),
      });

      const result = await response.json();
      console.log(result);

      if (result.status === "true") {
         console.log("DipanggilUlang")
         DataStokBarang(); // panggil ulang untuk refresh tampilan
      }
}

async function DataStokBarang(){
      const response = await fetch("/app/endpoint.go", {
         method: "POST",
         headers: {
            "Content-Type": "application/json",
         },
         body: JSON.stringify({
            tujuan: "ambil_suatu_stok_baju",
            nama: popup.getAttribute("data-nama"),
            gender: popup.getAttribute("data-gender"),
         }),
      });

      const result = await response.json();
      console.log(result);

      if (response.ok) {
         // Hapus DataTable dulu kalau sudah ada
         if ($.fn.dataTable.isDataTable('#table-stok')) {
            $('#table-stok').DataTable().clear().destroy();
         }

         Konteks_Popup.innerHTML = `
            <style>
               /* Container search box */
               .dataTables_filter {
               margin-bottom: 1rem;
               }
               .dataTables_filter label {
               font-weight: 600;
               color: #475569; /* slate-600 */
               font-family: 'Inter', sans-serif;
               }

               /* Search input styling */
               .dataTables_filter input {
               margin-left: 0.5rem;
               padding: 0.35rem 0.75rem;
               border: 1px solid #cbd5e1; /* slate-300 */
               border-radius: 0.5rem; /* rounded */
               background-color: #f8fafc; /* slate-50 */
               font-size: 0.875rem;
               font-family: 'Inter', sans-serif;
               color: #334155; /* slate-700 */
               transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
               }
               .dataTables_filter input:focus {
               outline: none;
               border-color: #2563eb; /* blue-600 */
               box-shadow: 0 0 0 3px rgb(37 99 235 / 0.3);
               background-color: white;
               }

               /* Info text */
               .dataTables_info {
               color: #64748b; /* slate-500 */
               font-family: 'Inter', sans-serif;
               font-size: 0.875rem;
               padding-top: 0.25rem;
               }

               /* Pagination container */
               .dataTables_paginate {
               margin-top: 1rem;
               font-family: 'Inter', sans-serif;
               }

               /* Pagination buttons */
               .dataTables_paginate .paginate_button {
               border-radius: 0.375rem;
               border: 1px solid transparent;
               padding: 0.25rem 0.75rem;
               margin: 0 0.15rem;
               cursor: pointer;
               color: #475569; /* slate-600 */
               background-color: #f1f5f9; /* slate-100 */
               transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
               user-select: none;
               font-weight: 600;
               }
               .dataTables_paginate .paginate_button:hover {
               background-color: #2563eb; /* blue-600 */
               color: white !important;
               border-color: #2563eb;
               box-shadow: 0 0 6px rgb(37 99 235 / 0.4);
               }
               .dataTables_paginate .paginate_button.current,
               .dataTables_paginate .paginate_button.current:hover {
               background-color: #1e40af; /* blue-800 */
               color: white !important;
               border-color: #1e40af;
               cursor: default;
               box-shadow: none;
               }

               /* Disabled pagination buttons */
               .dataTables_paginate .paginate_button.disabled {
               color: #94a3b8 !important; /* slate-400 */
               cursor: not-allowed;
               background-color: transparent;
               border-color: transparent;
               box-shadow: none;
               }

               /* Responsive wrapper for table */
               .dataTables_wrapper {
               font-family: 'Inter', sans-serif;
               color: #475569; /* slate-600 */
               }
            </style>
            <table id="table-stok" class="min-w-full bg-white rounded-lg shadow-md overflow-hidden text-slate-700 text-sm">
            <thead class="bg-slate-100">
               <tr>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">No</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Kode Baju</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Nama Baju</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Jenis</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Ukuran</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Status</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Aksi</th>
               </tr>
            </thead>
            <tbody id="DataBajuTable"></tbody>
            </table>
         `;

         // AMBIL LAGI tbody setelah dia muncul di DOM
         const dataBajuTable = document.getElementById("DataBajuTable");

         // Bersihkan isi tabel (sebenarnya sudah kosong karena di-assign innerHTML baru)
         dataBajuTable.innerHTML = "";

         // Tambahkan data
         result.forEach((baju, index) => {
         const row = document.createElement("tr");
         row.className = "hover:bg-slate-50 transition-colors duration-200 cursor-pointer";
         row.innerHTML = `
            <td class="py-3 px-4 border-t border-slate-200">${index + 1}</td>
            <td class="py-3 px-4 border-t border-slate-200 truncate overflow-hidden whitespace-nowrap max-w-[120px]">${baju.kode}</td>
            <td class="py-3 px-4 border-t border-slate-200 truncate overflow-hidden whitespace-nowrap max-w-[150px]">${baju.nama}</td>
            <td class="py-3 px-4 border-t border-slate-200 truncate overflow-hidden whitespace-nowrap max-w-[120px]">${baju.jenis}</td>
            <td class="py-3 px-4 border-t border-slate-200 truncate overflow-hidden whitespace-nowrap max-w-[100px]">${baju.ukuran}</td>
            <td class="py-3 px-4 border-t border-slate-200">
               <span class="inline-block px-3 py-1 ${baju.status === "Tersedia" ? "text-green-700 bg-green-100" : "text-yellow-700 bg-yellow-100"} rounded-full font-semibold shadow-sm select-none">
                  ${baju.status}
               </span>
            </td>
            <td class="py-3 px-4 border-t border-slate-200">
               <div class="flex gap-2">
                  <button class="text-red-600 hover:text-red-800" onclick="HapusChildBarang('${baju.kode}', '${baju.nama}', '${baju.jenis}', '${baju.ukuran}','${baju.id_induk}')">Hapus</button>
               </div>
            </td>
         `;
         dataBajuTable.appendChild(row);
      });
         // Inisialisasi ulang DataTable sekali setelah semua data masuk
         $('#table-stok').DataTable();
      } else {
         if ($.fn.dataTable.isDataTable('#table-stok')) {
            $('#table-stok').DataTable().clear().destroy();
         }

         Konteks_Popup.innerHTML = `
            <table id="table-stok" class="min-w-full bg-white rounded-lg shadow-md overflow-hidden text-slate-700 text-sm">
            <thead class="bg-slate-100">
               <tr>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">No</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Kode Baju</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Nama Baju</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Jenis</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Ukuran</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Status</th>
                  <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Aksi</th>
               </tr>
            </thead>
            <tbody id="DataBajuTable">
               <tr><td colspan="7" class="text-center text-slate-500 py-4">Data tidak ditemukan</td></tr>
            </tbody>
            </table>
         `;

         // Inisialisasi DataTable kosong
         $('#table-stok').DataTable();
      }
   }
</script>

<script>
  
  const popup = document.getElementById("popup-detail");
  const Konteks_Popup = document.getElementById("Edit_barang_Context");
  const nama = popup.getAttribute("data-nama");
  const gender = popup.getAttribute("data-gender");
  const tombolStok = document.getElementById("Stok_barang_popup_edit");
  tombolStok.addEventListener("click", DataStokBarang);

  const tombolRiwayat = document.getElementById("Riwayat_barang_popup_edit");
  tombolRiwayat.addEventListener("click", () => {
   Konteks_Popup.innerHTML = `
   <div class="p-6 text-slate-700 space-y-6">
      <h2 class="text-xl font-bold text-slate-800">Riwayat Barang (Admin)</h2>

      <div class="relative border-l-2 border-slate-200 ml-3 pl-6 space-y-8 max-h-[400px] overflow-y-auto pr-4">

         <!-- 1 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-blue-600 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">30 Juli 2025, 08:12 WIB</p>
            <h3 class="font-semibold text-base">üì¶ Barang Masuk: <span class="text-slate-800">Kaos Polos</span></h3>
            <p class="text-sm text-slate-600">Barang pertama kali dimasukkan ke sistem dengan stok <b>50</b>. Oleh <b>Faiz Admin</b></p>
         </div>

         <!-- 2 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-green-500 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">01 Agustus 2025, 10:00 WIB</p>
            <h3 class="font-semibold text-base">üîÅ Restock: <span class="text-slate-800">Kaos Polos</span></h3>
            <p class="text-sm text-slate-600">Stok ditambah dari <b>30</b> menjadi <b>45</b>. Oleh <b>Rudi Admin</b></p>
         </div>

         <!-- 3 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-yellow-500 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">02 Agustus 2025, 09:00 WIB</p>
            <h3 class="font-semibold text-base">‚úèÔ∏è Data Diedit: <span class="text-slate-800">Hoodie Tebal</span></h3>
            <p class="text-sm text-slate-600">Ukuran default diubah dari <b>M</b> ke <b>L</b>. Oleh <b>Admin Pusat</b></p>
         </div>

         <!-- 4 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-red-500 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">03 Agustus 2025, 14:30 WIB</p>
            <h3 class="font-semibold text-base">‚ö†Ô∏è Koreksi Stok: <span class="text-slate-800">Jaket Jeans</span></h3>
            <p class="text-sm text-slate-600">Stok dikoreksi dari <b>10</b> ke <b>8</b>. Oleh <b>Faiz Admin</b></p>
         </div>

         <!-- 5 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-slate-400 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">04 Agustus 2025, 16:00 WIB</p>
            <h3 class="font-semibold text-base">üö´ Barang Dinonaktifkan: <span class="text-slate-800">Sweater Tipis</span></h3>
            <p class="text-sm text-slate-600">Barang ini disembunyikan dari daftar aktif. Oleh <b>Admin Gudang</b></p>
         </div>

         <!-- 6 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-green-500 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">05 Agustus 2025, 08:45 WIB</p>
            <h3 class="font-semibold text-base">üîÅ Restock: <span class="text-slate-800">Hoodie Tebal</span></h3>
            <p class="text-sm text-slate-600">Stok ditambah dari <b>25</b> menjadi <b>35</b>. Oleh <b>Admin Gudang</b></p>
         </div>

         <!-- 7 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-yellow-500 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">06 Agustus 2025, 12:00 WIB</p>
            <h3 class="font-semibold text-base">‚úèÔ∏è Nama Produk Diubah</h3>
            <p class="text-sm text-slate-600">"Sweater Tebal" diubah menjadi "Sweater Premium". Oleh <b>Faiz Admin</b></p>
         </div>

         <!-- 8 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-blue-600 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">07 Agustus 2025, 09:00 WIB</p>
            <h3 class="font-semibold text-base">üì¶ Barang Masuk: <span class="text-slate-800">Topi Trucker</span></h3>
            <p class="text-sm text-slate-600">Barang baru ditambahkan ke sistem. Stok awal <b>20</b>. Oleh <b>Admin CS</b></p>
         </div>

         <!-- 9 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-red-500 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">08 Agustus 2025, 15:15 WIB</p>
            <h3 class="font-semibold text-base">‚ö†Ô∏è Koreksi Stok: <span class="text-slate-800">Kaos Polos</span></h3>
            <p class="text-sm text-slate-600">Audit menemukan 2 unit hilang, stok dikurangi menjadi <b>43</b>. Oleh <b>Audit Internal</b></p>
         </div>

         <!-- 10 -->
         <div class="group">
            <div class="absolute w-3 h-3 bg-slate-400 rounded-full -left-1.5 top-1"></div>
            <p class="text-xs text-slate-500">09 Agustus 2025, 18:00 WIB</p>
            <h3 class="font-semibold text-base">üö´ Barang Dinonaktifkan: <span class="text-slate-800">Topi Trucker</span></h3>
            <p class="text-sm text-slate-600">Barang sudah tidak tersedia di gudang pusat. Oleh <b>Admin CS</b></p>
         </div>

      </div>
      </div>

  `;
    
  });

  const tombolPenjualan = document.getElementById("Penjualan_barang_popup_edit");
  tombolPenjualan.addEventListener("click", () => {
   Konteks_Popup.innerHTML = `
   <!-- Ringkasan Atas -->
   <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-center mb-6">
   <div class="bg-slate-50 p-4 rounded-xl shadow text-slate-700">
      <div class="text-xs uppercase text-slate-500 font-semibold mb-1">Total Pendapatan</div>
      <div class="text-lg font-bold text-green-600">Rp 12.500.000</div>
   </div>
   <div class="bg-slate-50 p-4 rounded-xl shadow text-slate-700">
      <div class="text-xs uppercase text-slate-500 font-semibold mb-1">Total Terjual</div>
      <div class="text-lg font-bold text-blue-600">145 pcs</div>
   </div>
   <div class="bg-slate-50 p-4 rounded-xl shadow text-slate-700">
      <div class="text-xs uppercase text-slate-500 font-semibold mb-1">Neraca Stok</div>
      <div class="text-lg font-bold text-yellow-600">+35 pcs</div>
   </div>
   </div>

   <!-- Tabel Produk -->
   <table class="min-w-full bg-white rounded-lg shadow-md overflow-hidden text-slate-700 text-sm">
   <thead class="bg-slate-100">
      <tr>
         <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">UK</th>
         <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Nama Produk</th>
         <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Stok Saat Ini</th>
         <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Total Terjual</th>
         <th class="py-3 px-4 text-left uppercase font-semibold tracking-wide text-slate-600">Grafik Penjualan</th>
      </tr>
   </thead>
   <tbody>
      <tr class="hover:bg-slate-50 transition-colors duration-200 cursor-pointer">
         <td class="py-3 px-4 border-t border-slate-200">S</td>
         <td class="py-3 px-4 border-t border-slate-200">Terjual</td>
         <td class="py-3 px-4 border-t border-slate-200 text-blue-600 font-semibold">35 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200 text-green-600 font-semibold">60 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200"><canvas id="chart1" height="60"></canvas></td>
      </tr>
      <tr class="hover:bg-slate-50 transition-colors duration-200 cursor-pointer">
         <td class="py-3 px-4 border-t border-slate-200">M</td>
         <td class="py-3 px-4 border-t border-slate-200">Terjual</td>
         <td class="py-3 px-4 border-t border-slate-200 text-blue-600 font-semibold">35 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200 text-green-600 font-semibold">60 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200"><canvas id="chart1" height="60"></canvas></td>
      </tr>
      <tr class="hover:bg-slate-50 transition-colors duration-200 cursor-pointer">
         <td class="py-3 px-4 border-t border-slate-200">L</td>
         <td class="py-3 px-4 border-t border-slate-200">Terjual</td>
         <td class="py-3 px-4 border-t border-slate-200 text-blue-600 font-semibold">35 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200 text-green-600 font-semibold">60 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200"><canvas id="chart1" height="60"></canvas></td>
      </tr>
      <tr class="hover:bg-slate-50 transition-colors duration-200 cursor-pointer">
         <td class="py-3 px-4 border-t border-slate-200">X</td>
         <td class="py-3 px-4 border-t border-slate-200">Terjual</td>
         <td class="py-3 px-4 border-t border-slate-200 text-blue-600 font-semibold">35 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200 text-green-600 font-semibold">60 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200"><canvas id="chart1" height="60"></canvas></td>
      </tr>
      <tr class="hover:bg-slate-50 transition-colors duration-200 cursor-pointer">
         <td class="py-3 px-4 border-t border-slate-200">XL</td>
         <td class="py-3 px-4 border-t border-slate-200">Terjual</td>
         <td class="py-3 px-4 border-t border-slate-200 text-blue-600 font-semibold">35 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200 text-green-600 font-semibold">60 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200"><canvas id="chart1" height="60"></canvas></td>
      </tr>
      <tr class="hover:bg-slate-50 transition-colors duration-200 cursor-pointer">
         <td class="py-3 px-4 border-t border-slate-200">Tren Keseluruhan</td>
         <td class="py-3 px-4 border-t border-slate-200">Kaos</td>
         <td class="py-3 px-4 border-t border-slate-200 text-blue-600 font-semibold">15 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200 text-green-600 font-semibold">33 pcs</td>
         <td class="py-3 px-4 border-t border-slate-200"><canvas id="chart2" height="60"></canvas></td>
      </tr>
   </tbody>
   </table>
   `;

      setTimeout(() => {
      new Chart(document.getElementById('chart1'), {
         type: 'bar',
         data: {
            labels: ['Jan', 'Feb', 'Mar'],
            datasets: [{
            label: 'Kaos Polos',
            data: [20, 25, 15],
            backgroundColor: '#3b82f6'
            }]
         },
         options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
            y: { beginAtZero: true, ticks: { stepSize: 5 } }
            }
         }
      });

      new Chart(document.getElementById('chart2'), {
         type: 'line',
         data: {
            labels: ['Jan', 'Feb', 'Mar'],
            datasets: [{
            label: 'Kemeja Flanel',
            data: [10, 12, 11],
            borderColor: '#ef4444',
            backgroundColor: 'rgba(239, 68, 68, 0.2)',
            fill: true,
            tension: 0.4
            }]
         },
         options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
            y: { beginAtZero: true, ticks: { stepSize: 5 } }
            }
         }
      });
      }, 0);
  
  });

  const tombolDiscount = document.getElementById("Diskon_barang_popup_edit");
  tombolDiscount.addEventListener("click", () => {
      const hargaNormal = 100000;

      Konteks_Popup.innerHTML = `
      <div class=" justify-start bg-white rounded-lg shadow-lg p-6 text-slate-800">
         <h2 class="text-xl font-semibold mb-6">Diskon untuk Produk: <span class="font-bold">Kaos Polos</span></h2>

         <form id="form-diskon" class="space-y-5 text-left">

         <div>
            <label for="jenisDiskon" class="block mb-1 font-medium text-slate-700">Jenis Diskon</label>
            <select id="jenisDiskon" name="jenisDiskon" class="w-full rounded-md border border-slate-300 p-2 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:border-slate-400">
               <option value="percent">Persentase (%)</option>
               <option value="nominal">Nominal (Rp)</option>
            </select>
         </div>

         <div>
            <label for="nilaiDiskon" class="block mb-1 font-medium text-slate-700">Nilai Diskon</label>
            <input type="number" id="nilaiDiskon" name="nilaiDiskon" min="0" placeholder="Masukkan nilai diskon" class="w-full rounded-md border border-slate-300 p-2 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:border-slate-400" />
         </div>

         <div class="grid grid-cols-2 gap-2">
            <div>
               <label for="tanggalMulai" class="block mb-1 font-medium text-slate-700">Tanggal Mulai</label>
               <input type="date" id="tanggalMulai" name="tanggalMulai" class="w-full rounded-md border border-slate-300 p-2 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:border-slate-400" />
            </div>

            <div>
               <label for="tanggalBerakhir" class="block mb-1 font-medium text-slate-700">Tanggal Berakhir (Opsional)</label>
               <input type="date" id="tanggalBerakhir" name="tanggalBerakhir" class="w-full rounded-md border border-slate-300 p-2 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:border-slate-400" />
            </div>
         </div>

         <div>
            <label for="catatan" class="block mb-1 font-medium text-slate-700">Catatan</label>
            <textarea id="catatan" name="catatan" rows="3" placeholder="Misal: Diskon ulang tahun" class="w-full rounded-md border border-slate-300 p-2 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:border-slate-400"></textarea>
         </div>

         <div class="mt-4 font-semibold">
            <div>Harga Normal: <span id="hargaNormal">Rp ${hargaNormal.toLocaleString('id-ID')}</span></div>
            <div>Harga Setelah Diskon: <span id="hargaDiskon" class="text-blue-600">-</span></div>
         </div>

         <div class="mt-6 flex justify-start space-x-3">
            <button type="reset" class="px-4 py-2 rounded-md bg-slate-200 text-slate-700 hover:bg-slate-300 transition">Batal</button>
            <button type="submit" class="px-4 py-2 rounded-md bg-slate-700 text-white hover:bg-slate-900 transition">Simpan Diskon</button>
         </div>
         </form>

         
      </div>
   `;

   const jenisDiskon = document.getElementById('jenisDiskon');
   const nilaiDiskon = document.getElementById('nilaiDiskon');
   const hargaDiskon = document.getElementById('hargaDiskon');

   function updateHargaDiskon() {
      let diskon = Number(nilaiDiskon.value);
      if (isNaN(diskon) || diskon <= 0) {
         hargaDiskon.textContent = '-';
         hargaDiskon.classList.remove('text-red-600');
         hargaDiskon.classList.add('text-blue-600');
         return;
      }

      let hargaFinal;
      if (jenisDiskon.value === 'percent') {
         hargaFinal = hargaNormal - (hargaNormal * diskon / 100);
      } else {
         hargaFinal = hargaNormal - diskon;
      }

      if (hargaFinal < 0) hargaFinal = 0;

      hargaDiskon.textContent = `Rp ${hargaFinal.toLocaleString('id-ID')}`;

      if (hargaFinal < hargaNormal * 0.3) {
         hargaDiskon.classList.remove('text-blue-600');
         hargaDiskon.classList.add('text-red-600'); // warning kalau diskon terlalu besar
      } else {
         hargaDiskon.classList.remove('text-red-600');
         hargaDiskon.classList.add('text-blue-600');
      }
   }

   jenisDiskon.addEventListener('change', updateHargaDiskon);
   nilaiDiskon.addEventListener('input', updateHargaDiskon);

   document.getElementById('form-diskon').addEventListener('submit', (e) => {
      e.preventDefault();
      const dataDiskon = {
         jenis: jenisDiskon.value,
         nilai: Number(nilaiDiskon.value),
         mulai: document.getElementById('tanggalMulai').value,
         berakhir: document.getElementById('tanggalBerakhir').value,
         catatan: document.getElementById('catatan').value,
      };
      console.log('Data Diskon Disimpan:', dataDiskon);
      alert('Diskon berhasil disimpan!');
   });
  });

  const tombolCS = document.getElementById("CS_barang_popup_edit");
  tombolCS.addEventListener("click", () => {

  Konteks_Popup.innerHTML = `
    <div class="space-y-6">
      <!-- Ringkasan -->
      <div class="grid grid-cols-3 gap-4 text-center">
        <div class="bg-white shadow rounded-lg p-4">
          <div class="text-slate-500 text-sm">Total Feedback</div>
          <div class="text-xl font-bold text-slate-800">320</div>
        </div>
        <div class="bg-white shadow rounded-lg p-4">
          <div class="text-slate-500 text-sm">Pelanggan Puas</div>
          <div class="text-xl font-bold text-green-600">68%</div>
        </div>
        <div class="bg-white shadow rounded-lg p-4">
          <div class="text-slate-500 text-sm">Pelanggan Kecewa</div>
          <div class="text-xl font-bold text-red-600">12%</div>
        </div>
      </div>

      <!-- Chart Pie -->
      <div class="bg-white p-4 rounded-lg shadow">
        <h2 class="text-slate-800 text-lg font-semibold mb-2">Distribusi Kepuasan</h2>
        <canvas id="kepuasanChart" class="w-[200px] max-w-[200px] mx-auto"></canvas>
      </div>

      <!-- Komentar -->
      <div class="bg-white p-4 rounded-lg shadow max-h-64 overflow-y-auto">
        <h2 class="text-slate-800 text-lg font-semibold mb-3">Komentar Pelanggan</h2>
        <ul class="space-y-3">
          <li class="p-3 bg-slate-50 rounded border-l-4 border-green-500">
            <div class="text-sm text-slate-600 italic">"Barangnya bagus dan pengiriman cepat!"</div>
            <div class="text-xs text-slate-400 mt-1">‚Äî Rudi, 3 hari lalu</div>
          </li>
          <li class="p-3 bg-slate-50 rounded border-l-4 border-yellow-500">
            <div class="text-sm text-slate-600 italic">"Lumayan, tapi agak lambat sampai."</div>
            <div class="text-xs text-slate-400 mt-1">‚Äî Sari, 5 hari lalu</div>
          </li>
          <li class="p-3 bg-slate-50 rounded border-l-4 border-red-500">
            <div class="text-sm text-slate-600 italic">"Ukuran tidak sesuai, kecewa."</div>
            <div class="text-xs text-slate-400 mt-1">‚Äî Dika, 7 hari lalu</div>
          </li>
        </ul>
      </div>
    </div>
  `;

  // Chart.js init
  setTimeout(() => {
    const ctx = document.getElementById('kepuasanChart');
    new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['Puas', 'Biasa Saja', 'Kecewa'],
        datasets: [{
          data: [68, 20, 12],
          backgroundColor: ['#10b981', '#facc15', '#ef4444'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              color: '#334155',
              font: {
                size: 7
              }
            }
          }
        }
      }
    });
  }, 0);
  });
</script>



   </body>

</html>
